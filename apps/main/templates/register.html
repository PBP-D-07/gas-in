{% extends 'base.html' %} {% load static %} {% block content %}

<div
  class="relative min-h-screen pt-30 flex items-center justify-center w-full "
>
  <div class="w-80 p-10 shadow-xl border-gray-200 rounded-2xl">
    <h1 class="pb-4 text-xl text-center font-bold">Register</h1>
    <form id="register-form" method="POST" action="{% url 'main:register' %}">
      {% csrf_token %}
      <div class="flex flex-col w-full gap-4">
        <div>
          <label
            for="username"
            class="block text-sm font-medium mb-2"
          >
            Username
          </label>
          <div class="w-full flex items-center gap-2 border-b-2">
            <img
              src="{% static 'image/user.png' %}"
              alt="icon"
              class="w-4 h-auto"
            />
            <input
              id="username"
              name="username"
              type="text"
              required
              class="w-full px-2 py-1 focus:outline-none focus:ring-none transition-all"
              placeholder="Type your username"
            />
          </div>
        </div>

        <div>
          <label
            for="password"
            class="block text-sm font-medium mb-2"
          >
            Password
          </label>
          <div class="w-full flex items-center gap-2 border-b-2">
            <img
              src="{% static 'image/lock.png' %}"
              alt="icon"
              class="w-4 h-auto"
            />
            <input
              id="password"
              name="password"
              type="password"
              required
              class="w-full border-none px-2 py-1 focus:outline-none focus:ring-none transition-all"
              placeholder="Type your password"
            />
          </div>
        </div>
        <div class="pt-2 text-center border-gray-200">
          <p class="text-gray-500 text-sm">
            Don't have an account?
            <a
              href="{% url 'main:register' %}"
              class="text-blue-400 hover:text-blue-500 transition-all font-medium"
            >
              Register Now
            </a>
          </p>
        </div>

        <button
          type="submit"
          class="w-full bg-blue-400 hover:bg-blue-500 font-medium py-2 text-white rounded-full transition-all"
        >
          Sign In
        </button>
      </div>
    </form>
  </div>
</div>
<script>
  const form = document.getElementById("register-form");

  form.addEventListener("submit", async (e) => {
    e.preventDefault();

    const data = new FormData(form);

    try {
      const response = await fetch("/api/register/", {
        method: "POST",
        body: data,
      });

      const result = await response.json();

      if (!response.ok) {
        showToast(result.message, "", "error");
        return;
      }

      showToast(result.message, "", "success");
      setTimeout(() => {
        window.location.href = "/";
      }, 1500);
    } catch (error) {
      console.error("Error:", error);
    }
  });
</script>
{% endblock content %}
