{% extends 'base.html' %} {% load static %} {% block content %}

<div
  class="relative min-h-screen pt-30 flex items-center justify-center w-full"
>
  <div class="w-80 p-10 shadow-xl border-gray-100 border rounded-2xl">
    <h1 class="pb-4 text-xl text-center font-bold">Register</h1>
    <form id="register-form" method="POST" action="{% url 'main:register' %}">
      {% csrf_token %}
      <div class="flex flex-col w-full gap-4">
        <div>
          <label
            for="username"
            class="block text-sm font-medium mb-1"
          >
            Username
          </label>
          <div class="w-full flex items-center gap-2 border-b">
            <img
              src="{% static 'image/user.png' %}"
              alt="icon"
              class="w-4 h-auto"
            />
            <input
              id="username"
              name="username"
              type="text"
              required
              class="w-full border-none px-2 py-1 focus:outline-none focus:ring-none transition-all"
              placeholder="Type your username"
            />
          </div>
        </div>

        <div>
          <label
            for="password1"
            class="block text-sm font-medium mb-1"
          >
            Password
          </label>
          <div class="w-full flex items-center gap-2 border-b">
            <img
              src="{% static 'image/lock.png' %}"
              alt="icon"
              class="w-4 h-auto"
            />
            <input
              id="password1"
              name="password1"
              type="password"
              required
              class="w-full border-none px-2 py-1 focus:outline-none focus:ring-none transition-all"
              placeholder="Type your password"
            />
          </div>
        </div>

        <div>
          <label
            for="password2"
            class="block text-sm font-medium mb-1"
          >
            Confirm Password
          </label>
          <div class="w-full flex items-center gap-2 border-b">
            <img
              src="{% static 'image/lock.png' %}"
              alt="icon"
              class="w-4 h-auto"
            />
            <input
              id="password2"
              name="password2"
              type="password"
              required
              class="w-full border-none px-2 py-1 focus:outline-none focus:ring-none transition-all"
              placeholder="Confirm your password"
            />
          </div>
        </div>

        <button
          type="submit"
          class="w-full bg-gradient-to-r from-indigo-700 to-purple-800 hover:shadow-md hover:-translate-y-0.5 transform duration-500 font-medium py-2 text-white rounded-full transition-all"
        >
          Sign Up
        </button>

        <div class="text-center text-sm text-gray-500">
          Already have an account?
          <a
            href="{% url 'main:show_login' %}"
            class="text-purple-700 hover:text-purple-800 transition-all font-medium"
          >
            Login here
          </a>
        </div>
      </div>
    </form>
  </div>
</div>
<script>
  const form = document.getElementById("register-form");

  form.addEventListener("submit", async (e) => {
    e.preventDefault();

    const data = new FormData(form);

    try {
      const response = await fetch("/api/register/", {
        method: "POST",
        body: data,
      });

      const result = await response.json();

      if (!response.ok) {
        showToast(result.message, "", "error");
        return;
      }

      showToast(result.message, "", "success");
      setTimeout(() => {
        window.location.href = "/login/";
      }, 1500);
    } catch (error) {
      console.error("Error:", error);
      showToast("An error occurred. Please try again.", "", "error");
    }
  });
</script>
{% endblock content %}
