<!-- Delete Confirmation Modal -->
<div
  id="joinModal"
  class="hidden fixed inset-0 z-50 w-full flex items-center justify-center bg-gray-800 bg-opacity-50"
>
  <div
    id="joinModalContent"
    class="bg-white rounded-lg shadow-lg w-11/12 sm:w-1/2 lg:w-1/3 max-h-screen overflow-y-auto p-6"
  >
    <!-- Modal header -->
    <div class="flex items-center justify-between pb-3">
      <button
        type="button"
        class="text-gray-400 hover:text-gray-700"
        onclick="hideJoinModal()"
      >
        âœ•
      </button>
    </div>

    <!-- Modal body -->
    <div class="py-6 text-center">
      <p class="text-gray-700 text-md mb-3">
        Are you sure you want to join this event?
      </p>
    </div>

    <!-- Modal footer -->
    <div class="flex justify-end gap-3 pt-4">
      <button
        type="button"
        onclick="hideJoinModal()"
        class="px-3 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-100 transition-all"
      >
        Cancel
      </button>
      <button
        type="button"
        id="confirmJoinButton"
        class="px-3 py-2 bg-blue-400 hover:bg-blue-500 text-white rounded-md font-medium transition-all"
      >
        Join
      </button>
    </div>
  </div>
</div>

<script>
  function showJoinModal() {
    const modal = document.getElementById("joinModal");
    const modalContent = document.getElementById("joinModalContent");

    modal.classList.remove("hidden");
    setTimeout(() => {
      modalContent.classList.remove("opacity-0", "scale-95");
      modalContent.classList.add("opacity-100", "scale-100");
    }, 50);
  }

  function hideJoinModal() {
    const modal = document.getElementById("joinModal");
    const modalContent = document.getElementById("joinModalContent");

    modalContent.classList.remove("opacity-100", "scale-100");
    modalContent.classList.add("opacity-0", "scale-95");

    setTimeout(() => {
      modal.classList.add("hidden");
    }, 150);
  }

  document
    .getElementById("confirmJoinButton")
    .addEventListener("click", async () => {
      if (!eventId) return;

      try {
        const response = await fetch(`/event-maker/api/join/${eventId}/`, {
          method: "POST",
          headers: {
            "X-CSRFToken": "{{ csrf_token }}",
          },
        });

        const result = await response.json();

        if (!response.ok) {
          showToast(result.message, "", "error");
          return;
        }
        showToast(result.message, "", "success");
        hideJoinModal();
      } catch (error) {
        console.error("Error:", error);
      }
    });
</script>
