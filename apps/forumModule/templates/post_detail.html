{% extends 'base.html' %}
{% block content %}
<p>
  <a href="{% url 'forumModule:show_main' %}">
    <button>‚Üê Back to Post List</button>
  </a>
</p>

<div id="post-detail">
  <h1 id="post-title">Loading...</h1>

  <p id="post-meta">
    <i>Loading details...</i>
  </p>

  <p id="post-content"></p>
  <p id="post-author"></p>
</div>

<script>
  document.addEventListener("DOMContentLoaded", async () => {
    const postId = "{{ post.id }}"; 
    const url = `/forum/json/${postId}/`;

    try {
      const response = await fetch(url);
      if (!response.ok) throw new Error("Post not found");

      const data = await response.json();

      document.getElementById("post-title").textContent = data.category.toUpperCase();
      document.getElementById("post-content").textContent = data.description;

      const meta = [];
      if (data.is_hot) meta.push("üî• Hot");
      meta.push(`Created: ${new Date(data.created_at).toLocaleString()}`);
      meta.push(`Views: ${data.post_views}`);
      document.getElementById("post-meta").innerHTML = meta.join(" | ");

      document.getElementById("post-author").innerHTML =
        `<b>Author:</b> ${data.owner_username || "Anonymous"}`;

    } catch (err) {
      document.getElementById("post-detail").innerHTML =
        `<p style="color:red;">Error loading post: ${err.message}</p>`;
    }
  });
</script>

{% endblock content %}